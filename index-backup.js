// BACKUP OF COMPLEX CODE - REPLACING WITH SIMPLE VERSION